import{d as L,c as d,b as c,e as p,h as O,w as b,a as t,t as a,o as r,q as z,F as _,r as g,x as P,z as w,n as E,f as x,g as m,O as G}from"./app-D1aKf6HQ.js";import{_ as k}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-r842F5tj.js";import{_ as V}from"./Input.vue_vue_type_script_setup_true_lang-iBsxnF0S.js";import{_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-C0q0I7zG.js";import"./index-7JXnH-aQ.js";import"./VisuallyHidden-DVQk3b_7.js";import"./useForwardExpose-DIjMSpfh.js";import"./useForwardPropsEmits-CbqjJXiP.js";import"./index-BDqSilVs.js";import"./createLucideIcon-lstEoCdR.js";import"./index-ZGzMK47R.js";const R={class:"p-4"},U={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 mb-5"},H={class:"rounded-lg shadow p-4 w-1/3"},K={class:"flex items-center justify-between"},W={class:"flex gap-3"},X={class:"text-sm text-white text-center"},Y={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Z={class:"bg-tranparent border rounded-lg shadow-lg p-4"},tt={class:"flex justify-between items-center mb-4"},st={class:"relative"},et={class:"rounded-xl border border-sidebar-border/70 bg-background p-4"},ot={class:"mt-4 overflow-x-auto"},at={class:"w-full min-w-auto text-sm"},lt={key:0},nt={class:"px-2 py-2"},it={class:"px-2 py-2"},dt={class:"px-2 py-2"},rt={class:"px-2 py-2"},ut={class:"px-2 py-2"},ct={class:"px-4 py-3 text-sm"},pt={class:"flex items-center justify-between mt-4"},xt={class:"text-sm text-gray-500"},mt={class:"flex space-x-2"},vt=["disabled"],bt=["onClick"],_t=["disabled"],yt={class:"border rounded-lg shadow-lg p-4 flex flex-col h-[600px]"},ft={class:"flex-1 overflow-y-auto mb-4"},ht={class:"w-full min-w-auto text-sm"},gt={class:"px-2 py-3"},wt={class:"font-medium"},kt={class:"px-2 py-2"},Ct={class:"px-2 py-2"},St={class:"px-2 py-2"},$t={class:"px-4 py-3 text-sm"},jt={class:"border-t pt-4"},It={class:"space-y-3"},Nt={class:"flex space-x-2"},Pt={class:"flex gap-3 border-t pt-4 space-y-2 text-white"},Vt={class:"flex justify-between"},qt={class:"flex justify-between"},Tt={class:"flex justify-between"},v=8,Jt=L({__name:"index",props:{products:{}},setup(q){const T=q,u=x(()=>T.products),D=[{title:"Caja",href:"./caja"}],i=m([]),C=m(""),S=m("cash"),$=m("paid"),M=o=>{const s=parseInt(o.stock),e=i.value.find(l=>l.id==o.id);if(e){const l=e.quantity+1;if(l>s){alert(`Stock insuficiente para ${o.name}. 
                   Disponible: ${s} | Solicitado: ${l}`);return}e.quantity=l,e.total=e.price_unit*e.quantity}else{const l={id:o.id,name:o.name,quantity:1,price_unit:o.price_unit,total:o.price_unit*1,method:S.value,status:$.value,max_stock:s};i.value.push(l)}},A=(o,s)=>{const e=i.value[o];u.value.find(l=>l.id===e.id)},B=o=>{i.value.splice(o,1)},n=m(1),F=x(()=>{const o=(n.value-1)*v,s=o+v;return u.value.slice(o,s)}),y=x(()=>Math.ceil(u.value.length/v)),f=o=>{o>=1&&o<=y.value&&(n.value=o)},h=x(()=>i.value.reduce((o,s)=>o+s.total,0)),j=x(()=>(Number(h.value)*.18).toFixed(2)),I=x(()=>Number(h.value)+Number(j.value)),Q=async()=>{if(i.value.length===0){alert("Selecciona un producto");return}if(!confirm("Â¿Confirmar la venta?"))return;const o={items:i.value.map(e=>({id:e.id,name:e.name,quantity:e.quantity,status:e.status,method:e.method,total:e.total})),total:I.value,state:$.value,payment:S.value};console.log(o);const s=JSON.stringify(o);console.log(s),G.post("/box",o)};return(o,s)=>(r(),d(_,null,[c(p(O),{title:"Caja Registradora"}),c(J,{breadcrumbs:D},{default:b(()=>[t("div",R,[t("div",U,[s[5]||(s[5]=t("div",{class:"w-2/3"},[t("h1",{class:"text-2xl font-bold text-white mb-4"},"Sistema de Caja")],-1)),t("div",H,[t("div",K,[t("div",W,[s[3]||(s[3]=t("p",{class:"text-sm text-gray-500"},"Total productos: ",-1)),t("p",X,a(u.value.length),1)]),s[4]||(s[4]=t("i",{class:"fas fa-boxes text-3xl text-green-500"},null,-1))])])]),t("div",Y,[t("div",Z,[t("div",tt,[s[7]||(s[7]=t("h2",{class:"text-lg font-semibold text-white"},"Lista de Productos",-1)),t("div",st,[c(p(V),{modelValue:C.value,"onUpdate:modelValue":s[0]||(s[0]=e=>C.value=e),type:"text",placeholder:"Buscar producto...",class:"pl-8 pr-4 py-2"},null,8,["modelValue"]),s[6]||(s[6]=t("i",{class:"fas fa-search absolute left-2 top-3 text-gray-400"},null,-1))])]),t("section",et,[t("div",ot,[t("table",at,[s[10]||(s[10]=t("thead",{class:"border-b text-left"},[t("tr",null,[t("th",{class:"px-2 py-2"},"ID"),t("th",{class:"px-2 py-2"},"Nombre"),t("th",{class:"px-2 py-2"},"Descripcion"),t("th",{class:"px-2 py-2"},"Stock"),t("th",{class:"px-2 py-2"},"Precio unitario"),t("th",{class:"px-2 py-2"})])],-1)),t("tbody",null,[u.value.length===0?(r(),d("tr",lt,[...s[8]||(s[8]=[t("td",{colspan:"6",class:"px-2 py-4 text-center text-muted-foreground"}," No hay productos registrados. ",-1)])])):z("",!0),(r(!0),d(_,null,g(F.value,e=>(r(),d("tr",{key:e.id,class:"border-b"},[t("td",nt,a(e.id),1),t("td",it,a(e.name),1),t("td",dt,a(e.description),1),t("td",rt,a(e.stock),1),t("td",ut,a(e.price_unit),1),t("td",ct,[c(p(k),{type:"button",variant:"secondary",onClick:P(l=>M(e),["stop"])},{default:b(()=>[...s[9]||(s[9]=[w(" Agregar ",-1)])]),_:1},8,["onClick"])])]))),128))])])]),t("div",pt,[t("div",xt," Mostrando "+a((n.value-1)*v+1)+" - "+a(Math.min(n.value*v,u.value.length))+" de "+a(u.value.length)+" productos ",1),t("div",mt,[t("button",{onClick:s[1]||(s[1]=e=>f(n.value-1)),disabled:n.value===1,class:"px-3 py-1 rounded border border-gray-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"}," Anterior ",8,vt),(r(!0),d(_,null,g(y.value,e=>(r(),d("button",{key:e,onClick:l=>f(e),class:E(["px-3 py-1 rounded border text-sm",[n.value===e?"bg-blue-600 text-white border-blue-600":"border-gray-300 hover:bg-gray-50"]])},a(e),11,bt))),128)),t("button",{onClick:s[2]||(s[2]=e=>f(n.value+1)),disabled:n.value===y.value,class:"px-3 py-1 rounded border border-gray-300 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"}," Siguiente ",8,_t)])])])]),t("div",yt,[s[15]||(s[15]=t("h2",{class:"text-lg font-semibold text-white mb-4"},"Venta Actual",-1)),t("div",ft,[t("table",ht,[s[12]||(s[12]=t("thead",{class:"border-b text-left"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Producto"),t("th",{class:"px-2 py-2"},"Cantidad"),t("th",{class:"px-2 py-2"},"P. unitario"),t("th",{class:"px-2 py-2"},"Total"),t("th",{class:"px-2 py-2"})])],-1)),t("tbody",null,[(r(!0),d(_,null,g(i.value,(e,l)=>(r(),d("tr",{key:l,class:"border-b"},[t("td",gt,[t("p",wt,a(e.name),1)]),t("td",kt,[c(p(V),{type:"number",value:e.quantity,onInput:N=>A(l,parseInt(N.target.value)||0),class:"w-16 h-8 text-center",placeholder:"1"},null,8,["value","onInput"])]),t("td",Ct,"S/"+a(e.price_unit),1),t("td",St,"S/"+a(e.total),1),t("td",$t,[c(p(k),{type:"button",variant:"destructive",onClick:P(N=>B(l),["stop"])},{default:b(()=>[...s[11]||(s[11]=[w(" Eliminar ",-1)])]),_:1},8,["onClick"])])]))),128))])])]),t("div",jt,[s[14]||(s[14]=t("h3",{class:"font-medium text-gray-700 mb-2"},null,-1)),t("div",It,[t("div",Nt,[c(p(k),{onClick:Q,type:"submit"},{default:b(()=>[...s[13]||(s[13]=[w("Generar Pago ",-1),t("i",{class:"fas fa-plus"},null,-1)])]),_:1}),t("div",Pt,[t("div",Vt," sub total: "+a(h.value),1),t("div",qt," IGV: "+a(j.value),1),t("div",Tt," TOTAL: "+a(I.value.toFixed(2)),1)])])])])])])])]),_:1})],64))}});export{Jt as default};
